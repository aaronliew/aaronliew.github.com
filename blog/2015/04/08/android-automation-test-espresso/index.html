
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>White-Box Testing- Espresso - Aaron Liew's Blog</title>
  <meta name="author" content="Aaron Liew">

  
  <meta name="description" content="One common approach to UI testing is to run tests manually and verify that the app is behaving as expected. However, this approach can be very time- &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://aaronliew.github.io/blog/2015/04/08/android-automation-test-espresso">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Aaron Liew's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Aaron Liew's Blog</a></h1>
  
    <h2>Blog about Android Development</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:aaronliew.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">White-Box Testing- Espresso</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-08T01:13:17+08:00" pubdate data-updated="true">Apr 8<span>th</span>, 2015</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>One common approach to UI testing is to run tests manually and verify that the app is behaving as expected. However, this approach can be very time-consuming, tedious, and error-prone especially when we run tests on multiple devices. This is where Android Automated Tests becomes useful, it can perform repetitive task without human intervention.</p>

<p><strong>What is White-box Testing?</strong></p>

<p>There are two types tests: white-box test and black-box test. White-box test is method of testing software that tests internal structures or workings of an application. Black-box test is method of examining the functionality of an application without peering into its internal structures or workings. In this project, I did white-box test on my code using Espresso library.</p>

<p><strong>Advantage of Espresso</strong></p>

<p>The advantage of the Espresso is it is have synchronization feature, meaning it waits for UI events in the current message queue to process and default task to complete before it moves on to the next test operation.</p>

<p><strong>Demonstration of the Espresso</strong></p>

<p>I have written test script on animal gallery app. Here are the following steps to verify the functionality of the app:</p>

<ol>
<li>Launch Animal Gallery app</li>
<li>“Donation” screen will be shown up. Press “Later” button to proceed to main screen</li>
</ol>


<p><strong><em>Test on functionality of the grid view</em></strong></p>

<ol start="3">
  <li>Scrolls to the 3rd image and tap on it. </li>
  <li>In full screen viewpager, swipe to the left and view the next image.</li>
  <li>Back to the main screen</li>
  <li>Scrolls to the 6th image and tap on it. </li>
  <li>In full screen viewpager, swipe to the left twice and view the image.</li>
  <li>Swipe to the right again to go back the previous image.</li>
</ol>


<p><strong><em>Test on functionality of the navigation drawer</em></strong></p>

<ol start="9">
  <li>Tab on the navigation drawer icon to open the drawer</li>
  <li>Search for “Flickr: Dogs” category and tab on it.</li>
  <li>Open the drawer again and select “Tutorial” category.</li>
  <li>Swipes the tutorial screen.</li>
  <li>Done.</li>
</ol>


<p>Here is the demonstration of the test:</p>

<div class="embed-video-container"><iframe src="//www.youtube.com/embed/G9wMgmgJIfY" allowfullscreen></iframe></div>


<p><strong>Coding</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGridView</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">//Close the dialog and press later button</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">later_button</span><span class="o">))</span>
</span><span class='line'>        <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">isRoot</span><span class="o">()).</span><span class="na">perform</span><span class="o">(</span><span class="n">waitAtLeast</span><span class="o">(</span><span class="mi">2000</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Scroll the 3rd image of view and select it</span>
</span><span class='line'>        <span class="n">onData</span><span class="o">(</span><span class="n">anything</span><span class="o">())</span>
</span><span class='line'>        <span class="o">.</span><span class="na">inAdapterView</span><span class="o">(</span><span class="n">allOf</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">gridview</span><span class="o">),</span> <span class="n">isDisplayed</span><span class="o">()))</span>
</span><span class='line'>        <span class="o">.</span><span class="na">atPosition</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</span><span class='line'>        <span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">matches</span><span class="o">(</span><span class="n">isDisplayed</span><span class="o">()))</span>
</span><span class='line'>        <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">isRoot</span><span class="o">()).</span><span class="na">perform</span><span class="o">(</span><span class="n">waitAtLeast</span><span class="o">(</span><span class="mi">2000</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Do the swiping </span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">pager</span><span class="o">))</span>
</span><span class='line'>          <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeLeft</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Back to the main screen</span>
</span><span class='line'>        <span class="n">Espresso</span><span class="o">.</span><span class="na">pressBack</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Scroll the 5th image of view and select it</span>
</span><span class='line'>        <span class="n">onData</span><span class="o">(</span><span class="n">anything</span><span class="o">())</span>
</span><span class='line'>                <span class="o">.</span><span class="na">inAdapterView</span><span class="o">(</span><span class="n">allOf</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">gridview</span><span class="o">),</span> <span class="n">isDisplayed</span><span class="o">()))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">atPosition</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
</span><span class='line'>                <span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">matches</span><span class="o">(</span><span class="n">isDisplayed</span><span class="o">()))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">isRoot</span><span class="o">()).</span><span class="na">perform</span><span class="o">(</span><span class="n">waitAtLeast</span><span class="o">(</span><span class="mi">2000</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Do the swiping</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">pager</span><span class="o">))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeLeft</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">pager</span><span class="o">))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeLeft</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">pager</span><span class="o">))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeRight</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Back to main screen</span>
</span><span class='line'>        <span class="n">Espresso</span><span class="o">.</span><span class="na">pressBack</span><span class="o">();</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testNavDrawer</span><span class="o">(){</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Click on the later button</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">later_button</span><span class="o">))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Open and close the drawer</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withContentDescription</span><span class="o">(</span><span class="n">getActivity</span><span class="o">().</span><span class="na">getString</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">drawer_open</span><span class="o">)))</span>
</span><span class='line'>          <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withContentDescription</span><span class="o">(</span><span class="n">getActivity</span><span class="o">().</span><span class="na">getString</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">drawer_close</span><span class="o">)))</span>
</span><span class='line'>          <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Open the drawer and select dog category</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withContentDescription</span><span class="o">(</span><span class="n">getActivity</span><span class="o">().</span><span class="na">getString</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">drawer_open</span><span class="o">)))</span>
</span><span class='line'>          <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">Matchers</span><span class="o">.</span><span class="na">allOf</span><span class="o">(</span><span class="n">ViewMatchers</span><span class="o">.</span><span class="na">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sm_item_title</span><span class="o">),</span> <span class="n">hasSibling</span><span class="o">(</span><span class="n">ViewMatchers</span><span class="o">.</span><span class="na">withText</span><span class="o">(</span><span class="s">&quot;Flickr: Dogs&quot;</span><span class="o">)))).</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Open the drawer again and select tutorial</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withContentDescription</span><span class="o">(</span><span class="n">getActivity</span><span class="o">().</span><span class="na">getString</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">drawer_open</span><span class="o">)))</span>
</span><span class='line'>           <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">click</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">isRoot</span><span class="o">()).</span><span class="na">perform</span><span class="o">(</span><span class="n">waitAtLeast</span><span class="o">(</span><span class="mi">2000</span><span class="o">));</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span> <span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tutorial</span><span class="o">)).</span><span class="na">perform</span><span class="o">(</span> <span class="n">scrollTo</span><span class="o">(),</span> <span class="n">click</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Do the swiping on tutorial screen</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tutorial_pager</span><span class="o">))</span>
</span><span class='line'>        <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeLeft</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tutorial_pager</span><span class="o">))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeLeft</span><span class="o">());</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">withId</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tutorial_pager</span><span class="o">))</span>
</span><span class='line'>                <span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">swipeRight</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//Back to previous activity</span>
</span><span class='line'>        <span class="n">Espresso</span><span class="o">.</span><span class="na">pressBack</span><span class="o">();</span>
</span><span class='line'>        <span class="n">onView</span><span class="o">(</span><span class="n">isRoot</span><span class="o">()).</span><span class="na">perform</span><span class="o">(</span><span class="n">waitAtLeast</span><span class="o">(</span><span class="mi">2000</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Aaron Liew</span></span>

      








  


<time datetime="2015-04-08T01:13:17+08:00" pubdate data-updated="true">Apr 8<span>th</span>, 2015</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/automation/'>Automation</a>, <a class='category' href='/blog/categories/espresso/'>Espresso</a>, <a class='category' href='/blog/categories/white-box-test/'>White-box Test</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://aaronliew.github.io/blog/2015/04/08/android-automation-test-espresso/" data-via="" data-counturl="http://aaronliew.github.io/blog/2015/04/08/android-automation-test-espresso/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/03/18/day-nine/" title="Previous Post: Using options menus and customized dialogs for user interaction">&laquo; Using options menus and customized dialogs for user interaction</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/04/10/black-box-test-robotium/" title="Next Post: Black-Box Testing - Robotium">Black-Box Testing - Robotium &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/04/20/android-annotation-code-restructuring/">Android Annotation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/15/rxandroid/">RxAndroid</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/10/black-box-test-robotium/">Black-Box Testing - Robotium</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/08/android-automation-test-espresso/">White-Box Testing- Espresso</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/18/day-nine/">Using Options Menus and Customized Dialogs for User Interaction</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Aaron Liew -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
